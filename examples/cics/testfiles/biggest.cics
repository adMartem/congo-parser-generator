
exec cics HANDLE ABEND 
LABEL(ABEND-ROUTINE) 
END-EXEC

exec cics SYNCPOINT 
END-EXEC

exec cics XCTL 
PROGRAM (CDEMO-TO-PROGRAM)
COMMAREA(CARDDEMO-COMMAREA)
END-EXEC

exec cics RETURN 
TRANSID (LIT-THISTRANID) 
COMMAREA (WS-COMMAREA) 
LENGTH(LENGTH OF WS-COMMAREA) 
END-EXEC

exec cics RECEIVE 
MAP(LIT-THISMAP) 
MAPSET(LIT-THISMAPSET) 
INTO(CACTUPAI) 
RESP(WS-RESP-CD) 
RESP2(WS-REAS-CD) 
END-EXEC

exec cics SEND MAP(CCARD-NEXT-MAP) 
MAPSET(CCARD-NEXT-MAPSET) 
FROM(CACTUPAO) 
CURSOR 
ERASE 
FREEKB 
RESP(WS-RESP-CD) 
END-EXEC

exec cics READ 
DATASET (LIT-CARDXREFNAME-ACCT-PATH) 
RIDFLD (WS-CARD-RID-ACCT-ID-X) 
KEYLENGTH (LENGTH OF WS-CARD-RID-ACCT-ID-X) 
INTO (CARD-XREF-RECORD) 
LENGTH (LENGTH OF CARD-XREF-RECORD) 
RESP (WS-RESP-CD) 
RESP2 (WS-REAS-CD) 
END-EXEC

exec cics READ 
KEYLENGTH (LENGTH OF WS-CARD-RID-ACCT-ID-X) 
RESP2 (WS-REAS-CD) 
RESP (WS-RESP-CD) 
DATASET (LIT-ACCTFILENAME) 
LENGTH (LENGTH OF ACCOUNT-RECORD) 
INTO (ACCOUNT-RECORD) 
RIDFLD (WS-CARD-RID-ACCT-ID-X) 
END-EXEC

exec cics READ 
RESP2 (WS-REAS-CD) 
RESP (WS-RESP-CD) 
LENGTH (LENGTH OF CUSTOMER-RECORD) 
INTO (CUSTOMER-RECORD) 
KEYLENGTH (LENGTH OF WS-CARD-RID-CUST-ID-X) 
RIDFLD (WS-CARD-RID-CUST-ID-X) 
DATASET (LIT-CUSTFILENAME) 
END-EXEC

exec cics READ 
DATASET (LIT-ACCTFILENAME) 
RIDFLD (WS-CARD-RID-ACCT-ID-X) 
KEYLENGTH (LENGTH OF WS-CARD-RID-ACCT-ID-X) 
INTO (ACCOUNT-RECORD) 
LENGTH (LENGTH OF ACCOUNT-RECORD) 
RESP (WS-RESP-CD) 
RESP2 (WS-REAS-CD) 
END-EXEC

exec cics READ 
DATASET (LIT-CUSTFILENAME) 
RIDFLD (WS-CARD-RID-CUST-ID-X) 
KEYLENGTH (LENGTH OF WS-CARD-RID-CUST-ID-X) 
INTO (CUSTOMER-RECORD) 
LENGTH (LENGTH OF CUSTOMER-RECORD) 
RESP (WS-RESP-CD) 
RESP2 (WS-REAS-CD) 
END-EXEC

exec cics READ 
FILE (LIT-ACCTFILENAME) 
UPDATE 
RIDFLD (WS-CARD-RID-ACCT-ID-X) 
KEYLENGTH (LENGTH OF WS-CARD-RID-ACCT-ID-X) 
INTO (ACCOUNT-RECORD) 
LENGTH (LENGTH OF ACCOUNT-RECORD) 
RESP (WS-RESP-CD) 
RESP2 (WS-REAS-CD) 
END-EXEC

exec cics READ 
FILE (LIT-CUSTFILENAME) 
UPDATE 
RIDFLD (WS-CARD-RID-CUST-ID-X) 
KEYLENGTH (LENGTH OF WS-CARD-RID-CUST-ID-X) 
INTO (CUSTOMER-RECORD) 
LENGTH (LENGTH OF CUSTOMER-RECORD) 
RESP (WS-RESP-CD) 
RESP2 (WS-REAS-CD) 
END-EXEC

exec cics REWRITE FILE(LIT-ACCTFILENAME) 
FROM(ACCT-UPDATE-RECORD) 
LENGTH(LENGTH OF ACCT-UPDATE-RECORD) 
RESP (WS-RESP-CD) 
RESP2 (WS-REAS-CD) 
END-EXEC

exec cics REWRITE FILE(LIT-CUSTFILENAME) 
FROM(CUST-UPDATE-RECORD) 
LENGTH(LENGTH OF CUST-UPDATE-RECORD) 
RESP (WS-RESP-CD) 
RESP2 (WS-REAS-CD) 
END-EXEC

exec cics SYNCPOINT ROLLBACK 
END-EXEC

exec cics SEND 
FROM (ABEND-DATA) 
LENGTH(LENGTH OF ABEND-DATA) 
NOHANDLE 
ERASE 
END-EXEC

exec cics HANDLE ABEND 
CANCEL 
END-EXEC

exec cics ABEND 
ABCODE('9999') 
END-EXEC

exec cics HANDLE ABEND 
LABEL(ABEND-ROUTINE) 
END-EXEC

exec cics XCTL 
PROGRAM (CDEMO-TO-PROGRAM) 
COMMAREA(CARDDEMO-COMMAREA) 
END-EXEC

exec cics RETURN 
TRANSID (LIT-THISTRANID) 
COMMAREA (WS-COMMAREA) 
LENGTH(LENGTH OF WS-COMMAREA) 
END-EXEC

exec cics SEND MAP(CCARD-NEXT-MAP) 
MAPSET(CCARD-NEXT-MAPSET) 
FROM(CACTVWAO) 
CURSOR 
ERASE 
FREEKB 
RESP(WS-RESP-CD) 
END-EXEC

exec cics RECEIVE MAP(LIT-THISMAP) 
MAPSET(LIT-THISMAPSET) 
INTO(CACTVWAI) 
RESP(WS-RESP-CD) 
RESP2(WS-REAS-CD) 
END-EXEC

exec cics READ 
DATASET (LIT-CARDXREFNAME-ACCT-PATH) 
RIDFLD (WS-CARD-RID-ACCT-ID-X) 
KEYLENGTH (LENGTH OF WS-CARD-RID-ACCT-ID-X) 
INTO (CARD-XREF-RECORD) 
LENGTH (LENGTH OF CARD-XREF-RECORD) 
RESP (WS-RESP-CD) 
RESP2 (WS-REAS-CD) 
END-EXEC

exec cics READ 
DATASET (LIT-ACCTFILENAME) 
RIDFLD (WS-CARD-RID-ACCT-ID-X) 
KEYLENGTH (LENGTH OF WS-CARD-RID-ACCT-ID-X) 
INTO (ACCOUNT-RECORD) 
LENGTH (LENGTH OF ACCOUNT-RECORD) 
RESP (WS-RESP-CD) 
RESP2 (WS-REAS-CD) 
END-EXEC

exec cics READ 
DATASET (LIT-CUSTFILENAME) 
RIDFLD (WS-CARD-RID-CUST-ID-X) 
KEYLENGTH (LENGTH OF WS-CARD-RID-CUST-ID-X) 
INTO (CUSTOMER-RECORD) 
LENGTH (LENGTH OF CUSTOMER-RECORD) 
RESP (WS-RESP-CD) 
RESP2 (WS-REAS-CD) 
END-EXEC

exec cics SEND TEXT 
FROM(WS-RETURN-MSG) 
LENGTH(LENGTH OF WS-RETURN-MSG) 
ERASE 
FREEKB 
END-EXEC

exec cics RETURN 
END-EXEC

exec cics SEND TEXT 
FROM(WS-LONG-MSG) 
LENGTH(LENGTH OF WS-LONG-MSG) 
ERASE 
FREEKB 
END-EXEC

exec cics RETURN 
END-EXEC

exec cics SEND 
FROM (ABEND-DATA) 
LENGTH(LENGTH OF ABEND-DATA) 
NOHANDLE 
END-EXEC

exec cics HANDLE ABEND 
CANCEL 
END-EXEC

exec cics ABEND 
ABCODE('9999') 
END-EXEC

exec cics RETURN 
TRANSID (WS-TRANID) 
COMMAREA (CARDDEMO-COMMAREA) 
END-EXEC

exec cics XCTL PROGRAM(CDEMO-ADMIN-OPT-PGMNAME(WS-OPTION)) 
COMMAREA(CARDDEMO-COMMAREA) 
END-EXEC

exec cics XCTL PROGRAM(CDEMO-TO-PROGRAM) 
END-EXEC

exec cics SEND 
MAP('COADM1A') 
MAPSET('COADM01') 
FROM(COADM1AO) 
ERASE 
END-EXEC

exec cics RECEIVE 
MAP('COADM1A') 
MAPSET('COADM01') 
INTO(COADM1AI) 
RESP(WS-RESP-CD) 
RESP2(WS-REAS-CD) 
END-EXEC

exec cics RETURN 
TRANSID (WS-TRANID) 
COMMAREA (CARDDEMO-COMMAREA) 
END-EXEC

exec cics ASKTIME 
ABSTIME(WS-ABS-TIME) 
END-EXEC

exec cics FORMATTIME 
ABSTIME(WS-ABS-TIME) 
YYYYMMDD(WS-CUR-DATE-X10) 
DATESEP('-') 
TIME(WS-CUR-TIME-X08) 
TIMESEP(':') 
END-EXEC

exec cics XCTL PROGRAM(CDEMO-TO-PROGRAM) 
COMMAREA(CARDDEMO-COMMAREA) 
END-EXEC

exec cics SEND 
MAP('COBIL0A') 
MAPSET('COBIL00') 
FROM(COBIL0AO) 
ERASE 
CURSOR 
END-EXEC

exec cics RECEIVE 
MAP('COBIL0A') 
MAPSET('COBIL00') 
INTO(COBIL0AI) 
RESP(WS-RESP-CD) 
RESP2(WS-REAS-CD) 
END-EXEC

exec cics READ 
DATASET (WS-ACCTDAT-FILE) 
INTO (ACCOUNT-RECORD) 
LENGTH (LENGTH OF ACCOUNT-RECORD) 
RIDFLD (ACCT-ID) 
KEYLENGTH (LENGTH OF ACCT-ID) 
UPDATE 
RESP (WS-RESP-CD) 
RESP2 (WS-REAS-CD) 
END-EXEC

exec cics REWRITE 
DATASET (WS-ACCTDAT-FILE) 
FROM (ACCOUNT-RECORD) 
LENGTH (LENGTH OF ACCOUNT-RECORD) 
RESP (WS-RESP-CD) 
RESP2 (WS-REAS-CD) 
END-EXEC

exec cics READ 
DATASET (WS-CXACAIX-FILE) 
INTO (CARD-XREF-RECORD) 
LENGTH (LENGTH OF CARD-XREF-RECORD) 
RIDFLD (XREF-ACCT-ID) 
KEYLENGTH (LENGTH OF XREF-ACCT-ID) 
RESP (WS-RESP-CD) 
RESP2 (WS-REAS-CD) 
END-EXEC

exec cics STARTBR 
DATASET (WS-TRANSACT-FILE) 
RIDFLD (TRAN-ID) 
KEYLENGTH (LENGTH OF TRAN-ID) 
RESP (WS-RESP-CD) 
RESP2 (WS-REAS-CD) 
END-EXEC

exec cics READPREV 
DATASET (WS-TRANSACT-FILE) 
INTO (TRAN-RECORD) 
LENGTH (LENGTH OF TRAN-RECORD) 
RIDFLD (TRAN-ID) 
KEYLENGTH (LENGTH OF TRAN-ID) 
RESP (WS-RESP-CD) 
RESP2 (WS-REAS-CD) 
END-EXEC

exec cics ENDBR 
DATASET (WS-TRANSACT-FILE) 
END-EXEC

exec cics WRITE 
DATASET (WS-TRANSACT-FILE) 
FROM (TRAN-RECORD) 
LENGTH (LENGTH OF TRAN-RECORD) 
RIDFLD (TRAN-ID) 
KEYLENGTH (LENGTH OF TRAN-ID) 
RESP (WS-RESP-CD) 
RESP2 (WS-REAS-CD) 
END-EXEC

exec cics XCTL 
PROGRAM (LIT-MENUPGM) 
COMMAREA(CARDDEMO-COMMAREA) 
END-EXEC

exec cics XCTL 
PROGRAM (CCARD-NEXT-PROG) 
COMMAREA(CARDDEMO-COMMAREA) 
END-EXEC

exec cics XCTL 
PROGRAM (CCARD-NEXT-PROG) 
COMMAREA(CARDDEMO-COMMAREA) 
END-EXEC

exec cics RETURN 
TRANSID (LIT-THISTRANID) 
COMMAREA (WS-COMMAREA) 
LENGTH(LENGTH OF WS-COMMAREA) 
END-EXEC

exec cics SEND MAP(LIT-THISMAP) 
MAPSET(LIT-THISMAPSET) 
FROM(CCRDLIAO) 
CURSOR 
ERASE 
RESP(WS-RESP-CD) 
FREEKB 
END-EXEC

exec cics RECEIVE MAP(LIT-THISMAP) 
MAPSET(LIT-THISMAPSET) 
INTO(CCRDLIAI) 
RESP(WS-RESP-CD) 
END-EXEC

exec cics STARTBR 
DATASET(LIT-CARD-FILE) 
RIDFLD(WS-CARD-RID-CARDNUM) 
KEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM) 
GTEQ 
RESP(WS-RESP-CD) 
RESP2(WS-REAS-CD) 
END-EXEC

exec cics READNEXT 
DATASET(LIT-CARD-FILE) 
INTO (CARD-RECORD) 
LENGTH(LENGTH OF CARD-RECORD) 
RIDFLD(WS-CARD-RID-CARDNUM) 
KEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM) 
RESP(WS-RESP-CD) 
RESP2(WS-REAS-CD) 
END-EXEC

exec cics READNEXT 
DATASET(LIT-CARD-FILE) 
INTO (CARD-RECORD) 
LENGTH(LENGTH OF CARD-RECORD) 
RIDFLD(WS-CARD-RID-CARDNUM) 
KEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM) 
RESP(WS-RESP-CD) 
RESP2(WS-REAS-CD) 
END-EXEC

exec cics ENDBR FILE(LIT-CARD-FILE) 
END-EXEC

exec cics STARTBR 
DATASET(LIT-CARD-FILE) 
RIDFLD(WS-CARD-RID-CARDNUM) 
KEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM) 
GTEQ 
RESP(WS-RESP-CD) 
RESP2(WS-REAS-CD) 
END-EXEC

exec cics READPREV 
DATASET(LIT-CARD-FILE) 
INTO (CARD-RECORD) 
LENGTH(LENGTH OF CARD-RECORD) 
RIDFLD(WS-CARD-RID-CARDNUM) 
KEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM) 
RESP(WS-RESP-CD) 
RESP2(WS-REAS-CD) 
END-EXEC

exec cics READPREV 
DATASET(LIT-CARD-FILE) 
INTO (CARD-RECORD) 
LENGTH(LENGTH OF CARD-RECORD) 
RIDFLD(WS-CARD-RID-CARDNUM) 
KEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM) 
RESP(WS-RESP-CD) 
RESP2(WS-REAS-CD) 
END-EXEC

exec cics ENDBR FILE(LIT-CARD-FILE) 
END-EXEC

exec cics SEND TEXT 
FROM(WS-ERROR-MSG) 
LENGTH(LENGTH OF WS-ERROR-MSG) 
ERASE 
FREEKB 
END-EXEC

exec cics RETURN 
END-EXEC

exec cics SEND TEXT 
FROM(WS-LONG-MSG) 
LENGTH(LENGTH OF WS-LONG-MSG) 
ERASE 
FREEKB 
END-EXEC

exec cics RETURN 
END-EXEC

exec cics HANDLE ABEND 
LABEL(ABEND-ROUTINE) 
END-EXEC

exec cics XCTL 
PROGRAM (CDEMO-TO-PROGRAM) 
COMMAREA(CARDDEMO-COMMAREA) 
END-EXEC

exec cics RETURN 
TRANSID (LIT-THISTRANID) 
COMMAREA (WS-COMMAREA) 
LENGTH(LENGTH OF WS-COMMAREA) 
END-EXEC

exec cics SEND MAP(CCARD-NEXT-MAP) 
MAPSET(CCARD-NEXT-MAPSET) 
FROM(CCRDSLAO) 
CURSOR 
ERASE 
FREEKB 
RESP(WS-RESP-CD) 
END-EXEC

exec cics RECEIVE MAP(LIT-THISMAP) 
MAPSET(LIT-THISMAPSET) 
INTO(CCRDSLAI) 
RESP(WS-RESP-CD) 
RESP2(WS-REAS-CD) 
END-EXEC

exec cics READ 
FILE (LIT-CARDFILENAME) 
RIDFLD (WS-CARD-RID-CARDNUM) 
KEYLENGTH (LENGTH OF WS-CARD-RID-CARDNUM) 
INTO (CARD-RECORD) 
LENGTH (LENGTH OF CARD-RECORD) 
RESP (WS-RESP-CD) 
RESP2 (WS-REAS-CD) 
END-EXEC

exec cics READ 
FILE (LIT-CARDFILENAME-ACCT-PATH) 
RIDFLD (WS-CARD-RID-ACCT-ID) 
KEYLENGTH (LENGTH OF WS-CARD-RID-ACCT-ID) 
INTO (CARD-RECORD) 
LENGTH (LENGTH OF CARD-RECORD) 
RESP (WS-RESP-CD) 
RESP2 (WS-REAS-CD) 
END-EXEC

exec cics SEND TEXT 
FROM(WS-LONG-MSG) 
LENGTH(LENGTH OF WS-LONG-MSG) 
ERASE 
FREEKB 
END-EXEC

exec cics RETURN 
END-EXEC

exec cics SEND TEXT 
FROM(WS-RETURN-MSG) 
LENGTH(LENGTH OF WS-RETURN-MSG) 
ERASE 
FREEKB 
END-EXEC

exec cics RETURN 
END-EXEC

exec cics SEND 
FROM (ABEND-DATA) 
LENGTH(LENGTH OF ABEND-DATA) 
NOHANDLE 
END-EXEC

exec cics HANDLE ABEND 
CANCEL 
END-EXEC

exec cics ABEND 
ABCODE('9999') 
END-EXEC

exec cics HANDLE ABEND 
LABEL(ABEND-ROUTINE) 
END-EXEC

exec cics SYNCPOINT 
END-EXEC

exec cics XCTL 
PROGRAM (CDEMO-TO-PROGRAM) 
COMMAREA(CARDDEMO-COMMAREA) 
END-EXEC

exec cics RETURN 
TRANSID (LIT-THISTRANID) 
COMMAREA (WS-COMMAREA) 
LENGTH(LENGTH OF WS-COMMAREA) 
END-EXEC

exec cics RECEIVE MAP(LIT-THISMAP) 
MAPSET(LIT-THISMAPSET) 
INTO(CCRDUPAI) 
RESP(WS-RESP-CD) 
RESP2(WS-REAS-CD) 
END-EXEC

exec cics SEND MAP(CCARD-NEXT-MAP) 
MAPSET(CCARD-NEXT-MAPSET) 
FROM(CCRDUPAO) 
CURSOR 
ERASE 
FREEKB 
RESP(WS-RESP-CD) 
END-EXEC

exec cics READ 
FILE (LIT-CARDFILENAME) 
RIDFLD (WS-CARD-RID-CARDNUM) 
KEYLENGTH (LENGTH OF WS-CARD-RID-CARDNUM) 
INTO (CARD-RECORD) 
LENGTH (LENGTH OF CARD-RECORD) 
RESP (WS-RESP-CD) 
RESP2 (WS-REAS-CD) 
END-EXEC

exec cics READ 
FILE (LIT-CARDFILENAME) 
UPDATE 
RIDFLD (WS-CARD-RID-CARDNUM) 
KEYLENGTH (LENGTH OF WS-CARD-RID-CARDNUM) 
INTO (CARD-RECORD) 
LENGTH (LENGTH OF CARD-RECORD) 
RESP (WS-RESP-CD) 
RESP2 (WS-REAS-CD) 
END-EXEC

exec cics REWRITE FILE(LIT-CARDFILENAME) 
FROM(CARD-UPDATE-RECORD) 
LENGTH(LENGTH OF CARD-UPDATE-RECORD) 
RESP (WS-RESP-CD) 
RESP2 (WS-REAS-CD) 
END-EXEC

exec cics SEND 
FROM (ABEND-DATA) 
LENGTH(LENGTH OF ABEND-DATA) 
NOHANDLE 
ERASE 
END-EXEC

exec cics HANDLE ABEND 
CANCEL 
END-EXEC

exec cics ABEND 
ABCODE('9999') 
END-EXEC

exec cics RETURN 
TRANSID (WS-TRANID) 
COMMAREA (CARDDEMO-COMMAREA) 
END-EXEC

exec cics XCTL PROGRAM(CDEMO-MENU-OPT-PGMNAME(WS-OPTION)) 
COMMAREA(CARDDEMO-COMMAREA) 
END-EXEC

exec cics XCTL PROGRAM(CDEMO-TO-PROGRAM) 
END-EXEC

exec cics SEND 
MAP('COMEN1A') 
MAPSET('COMEN01') 
FROM(COMEN1AO) 
ERASE 
END-EXEC

exec cics RECEIVE 
MAP('COMEN1A') 
MAPSET('COMEN01') 
INTO(COMEN1AI) 
RESP(WS-RESP-CD) 
RESP2(WS-REAS-CD) 
END-EXEC

exec cics RETURN 
TRANSID (WS-TRANID) 
COMMAREA (CARDDEMO-COMMAREA) 
END-EXEC

exec cics WRITEQ TD 
QUEUE ('JOBS') 
FROM (JCL-RECORD) 
LENGTH (LENGTH OF JCL-RECORD) 
RESP(WS-RESP-CD) 
RESP2(WS-REAS-CD) 
END-EXEC

exec cics XCTL PROGRAM(CDEMO-TO-PROGRAM) 
COMMAREA(CARDDEMO-COMMAREA) 
END-EXEC

exec cics SEND 
MAP('CORPT0A') 
MAPSET('CORPT00') 
FROM(CORPT0AO) 
ERASE 
CURSOR 
END-EXEC

exec cics SEND 
MAP('CORPT0A') 
MAPSET('CORPT00') 
FROM(CORPT0AO) 
ERASE
CURSOR 
END-EXEC

exec cics RETURN 
TRANSID (WS-TRANID) 
COMMAREA (CARDDEMO-COMMAREA) 
LENGTH(LENGTH OF CARDDEMO-COMMAREA)
END-EXEC

exec cics RECEIVE 
MAP('CORPT0A') 
MAPSET('CORPT00') 
INTO(CORPT0AI) 
RESP(WS-RESP-CD) 
RESP2(WS-REAS-CD) 
END-EXEC

exec cics RETURN 
TRANSID (WS-TRANID) 
COMMAREA (CARDDEMO-COMMAREA) 
LENGTH(LENGTH OF CARDDEMO-COMMAREA) 
END-EXEC

exec cics RECEIVE 
MAP('COSGN0A') 
MAPSET('COSGN00') 
RESP(WS-RESP-CD) 
RESP2(WS-REAS-CD) 
END-EXEC

exec cics SEND 
MAP('COSGN0A') 
MAPSET('COSGN00') 
FROM(COSGN0AO) 
ERASE 
CURSOR 
END-EXEC

exec cics SEND TEXT 
FROM(WS-MESSAGE) 
LENGTH(LENGTH OF WS-MESSAGE) 
ERASE 
FREEKB 
END-EXEC

exec cics RETURN 
END-EXEC

exec cics ASSIGN 
APPLID(APPLIDO OF COSGN0AO) 
END-EXEC

exec cics ASSIGN 
SYSID(SYSIDO OF COSGN0AO) 
END-EXEC

exec cics READ 
DATASET (WS-USRSEC-FILE) 
INTO (SEC-USER-DATA) 
LENGTH (LENGTH OF SEC-USER-DATA) 
RIDFLD (WS-USER-ID) 
KEYLENGTH (LENGTH OF WS-USER-ID) 
RESP (WS-RESP-CD) 
RESP2 (WS-REAS-CD) 
END-EXEC

exec cics XCTL 
PROGRAM ('COADM01C') 
COMMAREA(CARDDEMO-COMMAREA) 
END-EXEC

exec cics XCTL 
PROGRAM ('COMEN01C') 
COMMAREA(CARDDEMO-COMMAREA) 
END-EXEC

exec cics RETURN 
TRANSID (WS-TRANID) 
COMMAREA (CARDDEMO-COMMAREA) 
END-EXEC

exec cics XCTL PROGRAM(CDEMO-TO-PROGRAM) 
COMMAREA(CARDDEMO-COMMAREA) 
END-EXEC

exec cics XCTL PROGRAM(CDEMO-TO-PROGRAM) 
COMMAREA(CARDDEMO-COMMAREA) 
END-EXEC

exec cics SEND 
MAP('COTRN0A') 
MAPSET('COTRN00') 
FROM(COTRN0AO) 
ERASE 
CURSOR 
END-EXEC

exec cics SEND 
MAP('COTRN0A') 
MAPSET('COTRN00') 
FROM(COTRN0AO) 
ERASE
CURSOR 
END-EXEC

exec cics RECEIVE 
MAP('COTRN0A') 
MAPSET('COTRN00') 
INTO(COTRN0AI) 
RESP(WS-RESP-CD) 
RESP2(WS-REAS-CD) 
END-EXEC

exec cics STARTBR 
DATASET (WS-TRANSACT-FILE) 
RIDFLD (TRAN-ID) 
KEYLENGTH (LENGTH OF TRAN-ID) 
GTEQ
RESP (WS-RESP-CD) 
RESP2 (WS-REAS-CD) 
END-EXEC

exec cics READNEXT 
DATASET (WS-TRANSACT-FILE) 
INTO (TRAN-RECORD) 
LENGTH (LENGTH OF TRAN-RECORD) 
RIDFLD (TRAN-ID) 
KEYLENGTH (LENGTH OF TRAN-ID) 
RESP (WS-RESP-CD) 
RESP2 (WS-REAS-CD) 
END-EXEC

exec cics READPREV 
DATASET (WS-TRANSACT-FILE) 
INTO (TRAN-RECORD) 
LENGTH (LENGTH OF TRAN-RECORD) 
RIDFLD (TRAN-ID) 
KEYLENGTH (LENGTH OF TRAN-ID) 
RESP (WS-RESP-CD) 
RESP2 (WS-REAS-CD) 
END-EXEC

exec cics ENDBR 
DATASET (WS-TRANSACT-FILE) 
END-EXEC

exec cics RETURN 
TRANSID (WS-TRANID) 
COMMAREA (CARDDEMO-COMMAREA) 
END-EXEC

exec cics XCTL PROGRAM(CDEMO-TO-PROGRAM) 
COMMAREA(CARDDEMO-COMMAREA) 
END-EXEC

exec cics SEND 
MAP('COTRN1A') 
MAPSET('COTRN01') 
FROM(COTRN1AO) 
ERASE 
CURSOR 
END-EXEC

exec cics RECEIVE 
MAP('COTRN1A') 
MAPSET('COTRN01') 
INTO(COTRN1AI) 
RESP(WS-RESP-CD) 
RESP2(WS-REAS-CD) 
END-EXEC

exec cics READ 
DATASET (WS-TRANSACT-FILE) 
INTO (TRAN-RECORD) 
LENGTH (LENGTH OF TRAN-RECORD) 
RIDFLD (TRAN-ID) 
KEYLENGTH (LENGTH OF TRAN-ID) 
UPDATE 
RESP (WS-RESP-CD) 
RESP2 (WS-REAS-CD) 
END-EXEC

exec cics RETURN 
TRANSID (WS-TRANID) 
COMMAREA (CARDDEMO-COMMAREA) 
END-EXEC

exec cics XCTL PROGRAM(CDEMO-TO-PROGRAM) 
COMMAREA(CARDDEMO-COMMAREA) 
END-EXEC

exec cics SEND 
MAP('COTRN2A') 
MAPSET('COTRN02') 
FROM(COTRN2AO) 
ERASE 
CURSOR 
END-EXEC

exec cics RETURN 
TRANSID (WS-TRANID) 
COMMAREA (CARDDEMO-COMMAREA) 
LENGTH(LENGTH OF CARDDEMO-COMMAREA)
END-EXEC

exec cics RECEIVE 
MAP('COTRN2A') 
MAPSET('COTRN02') 
INTO(COTRN2AI) 
RESP(WS-RESP-CD) 
RESP2(WS-REAS-CD) 
END-EXEC

exec cics READ 
DATASET (WS-CXACAIX-FILE) 
INTO (CARD-XREF-RECORD) 
LENGTH (LENGTH OF CARD-XREF-RECORD) 
RIDFLD (XREF-ACCT-ID) 
KEYLENGTH (LENGTH OF XREF-ACCT-ID) 
RESP (WS-RESP-CD) 
RESP2 (WS-REAS-CD) 
END-EXEC

exec cics READ 
DATASET (WS-CCXREF-FILE) 
INTO (CARD-XREF-RECORD) 
LENGTH (LENGTH OF CARD-XREF-RECORD) 
RIDFLD (XREF-CARD-NUM) 
KEYLENGTH (LENGTH OF XREF-CARD-NUM) 
RESP (WS-RESP-CD) 
RESP2 (WS-REAS-CD) 
END-EXEC

exec cics STARTBR 
DATASET (WS-TRANSACT-FILE) 
RIDFLD (TRAN-ID) 
KEYLENGTH (LENGTH OF TRAN-ID) 
RESP (WS-RESP-CD) 
RESP2 (WS-REAS-CD) 
END-EXEC

exec cics READPREV 
DATASET (WS-TRANSACT-FILE) 
INTO (TRAN-RECORD) 
LENGTH (LENGTH OF TRAN-RECORD) 
RIDFLD (TRAN-ID) 
KEYLENGTH (LENGTH OF TRAN-ID) 
RESP (WS-RESP-CD) 
RESP2 (WS-REAS-CD) 
END-EXEC

exec cics ENDBR 
DATASET (WS-TRANSACT-FILE) 
END-EXEC

exec cics WRITE 
DATASET (WS-TRANSACT-FILE) 
FROM (TRAN-RECORD) 
LENGTH (LENGTH OF TRAN-RECORD) 
RIDFLD (TRAN-ID) 
KEYLENGTH (LENGTH OF TRAN-ID) 
RESP (WS-RESP-CD) 
RESP2 (WS-REAS-CD) 
END-EXEC

exec cics RETURN 
TRANSID (WS-TRANID) 
COMMAREA (CARDDEMO-COMMAREA) 
END-EXEC

exec cics XCTL PROGRAM(CDEMO-TO-PROGRAM) 
COMMAREA(CARDDEMO-COMMAREA) 
END-EXEC

exec cics XCTL PROGRAM(CDEMO-TO-PROGRAM) 
COMMAREA(CARDDEMO-COMMAREA) 
END-EXEC

exec cics XCTL PROGRAM(CDEMO-TO-PROGRAM) 
COMMAREA(CARDDEMO-COMMAREA) 
END-EXEC

exec cics SEND 
MAP('COUSR0A') 
MAPSET('COUSR00') 
FROM(COUSR0AO) 
ERASE 
CURSOR 
END-EXEC

exec cics SEND 
MAP('COUSR0A') 
MAPSET('COUSR00') 
FROM(COUSR0AO) 
ERASE
CURSOR 
END-EXEC

exec cics RECEIVE 
MAP('COUSR0A') 
MAPSET('COUSR00') 
INTO(COUSR0AI) 
RESP(WS-RESP-CD) 
RESP2(WS-REAS-CD) 
END-EXEC

exec cics STARTBR 
DATASET (WS-USRSEC-FILE) 
RIDFLD (SEC-USR-ID) 
KEYLENGTH (LENGTH OF SEC-USR-ID) 
GTEQ
RESP (WS-RESP-CD) 
RESP2 (WS-REAS-CD) 
END-EXEC

exec cics READNEXT 
DATASET (WS-USRSEC-FILE) 
INTO (SEC-USER-DATA) 
LENGTH (LENGTH OF SEC-USER-DATA) 
RIDFLD (SEC-USR-ID) 
KEYLENGTH (LENGTH OF SEC-USR-ID) 
RESP (WS-RESP-CD) 
RESP2 (WS-REAS-CD) 
END-EXEC

exec cics READPREV 
DATASET (WS-USRSEC-FILE) 
INTO (SEC-USER-DATA) 
LENGTH (LENGTH OF SEC-USER-DATA) 
RIDFLD (SEC-USR-ID) 
KEYLENGTH (LENGTH OF SEC-USR-ID) 
RESP (WS-RESP-CD) 
RESP2 (WS-REAS-CD) 
END-EXEC

exec cics ENDBR 
DATASET (WS-USRSEC-FILE) 
END-EXEC

exec cics RETURN 
TRANSID (WS-TRANID) 
COMMAREA (CARDDEMO-COMMAREA) 
END-EXEC

exec cics XCTL PROGRAM(CDEMO-TO-PROGRAM) 
COMMAREA(CARDDEMO-COMMAREA) 
END-EXEC

exec cics SEND 
MAP('COUSR1A') 
MAPSET('COUSR01') 
FROM(COUSR1AO) 
ERASE 
CURSOR 
END-EXEC

exec cics RECEIVE 
MAP('COUSR1A') 
MAPSET('COUSR01') 
INTO(COUSR1AI) 
RESP(WS-RESP-CD) 
RESP2(WS-REAS-CD) 
END-EXEC

exec cics WRITE 
DATASET (WS-USRSEC-FILE) 
FROM (SEC-USER-DATA) 
LENGTH (LENGTH OF SEC-USER-DATA) 
RIDFLD (SEC-USR-ID) 
KEYLENGTH (LENGTH OF SEC-USR-ID) 
RESP (WS-RESP-CD) 
RESP2 (WS-REAS-CD) 
END-EXEC

exec cics RETURN 
TRANSID (WS-TRANID) 
COMMAREA (CARDDEMO-COMMAREA) 
END-EXEC

exec cics XCTL PROGRAM(CDEMO-TO-PROGRAM) 
COMMAREA(CARDDEMO-COMMAREA) 
END-EXEC

exec cics SEND 
MAP('COUSR2A') 
MAPSET('COUSR02') 
FROM(COUSR2AO) 
ERASE 
CURSOR 
END-EXEC

exec cics RECEIVE 
MAP('COUSR2A') 
MAPSET('COUSR02') 
INTO(COUSR2AI) 
RESP(WS-RESP-CD) 
RESP2(WS-REAS-CD) 
END-EXEC

exec cics READ 
DATASET (WS-USRSEC-FILE) 
INTO (SEC-USER-DATA) 
LENGTH (LENGTH OF SEC-USER-DATA) 
RIDFLD (SEC-USR-ID) 
KEYLENGTH (LENGTH OF SEC-USR-ID) 
UPDATE 
RESP (WS-RESP-CD) 
RESP2 (WS-REAS-CD) 
END-EXEC

exec cics REWRITE 
DATASET (WS-USRSEC-FILE) 
FROM (SEC-USER-DATA) 
LENGTH (LENGTH OF SEC-USER-DATA) 
RESP (WS-RESP-CD) 
RESP2 (WS-REAS-CD) 
END-EXEC

exec cics RETURN 
TRANSID (WS-TRANID) 
COMMAREA (CARDDEMO-COMMAREA) 
END-EXEC

exec cics XCTL PROGRAM(CDEMO-TO-PROGRAM) 
COMMAREA(CARDDEMO-COMMAREA) 
END-EXEC

exec cics SEND 
MAP('COUSR3A') 
MAPSET('COUSR03') 
FROM(COUSR3AO) 
ERASE 
CURSOR 
END-EXEC

exec cics RECEIVE 
MAP('COUSR3A') 
MAPSET('COUSR03') 
INTO(COUSR3AI) 
RESP(WS-RESP-CD) 
RESP2(WS-REAS-CD) 
END-EXEC

exec cics READ 
DATASET (WS-USRSEC-FILE) 
INTO (SEC-USER-DATA) 
LENGTH (LENGTH OF SEC-USER-DATA) 
RIDFLD (SEC-USR-ID) 
KEYLENGTH (LENGTH OF SEC-USR-ID) 
UPDATE 
RESP (WS-RESP-CD) 
RESP2 (WS-REAS-CD) 
END-EXEC

exec cics DELETE 
DATASET (WS-USRSEC-FILE) 
RESP (WS-RESP-CD) 
RESP2 (WS-REAS-CD) 
END-EXEC
